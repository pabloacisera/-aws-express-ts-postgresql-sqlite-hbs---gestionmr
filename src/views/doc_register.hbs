<link rel="stylesheet" href="/css/doc_register.css">

<input type="hidden" id="control-id" value="{{controlId}}" />

<div class="container mt-4"> <!-- AGREGAR mt-4 AQU√ç -->
    {{!-- Agregar un header m√°s coherente --}}
    <div class="mb-4">
        <h2>Documentaci√≥n del Registro</h2>
        <p class="text-muted">Gesti√≥n de certificados para el control ID: {{controlId}}</p>
    </div>
    <!-- Estado general -->
    {{#if statusCertificates.allComplete}}
    <div class="status-badge status-complete mb-1">
        ‚úÖ Todos los certificados est√°n completos
    </div>
    {{else}}
    <div class="status-badge status-incomplete mb-1">
        ‚ö†Ô∏è Faltan {{statusCertificates.missingFields.length}} certificado(s)
    </div>
    {{/if}}

    <!-- Lista de certificados pendientes -->
    {{#unless statusCertificates.allComplete}}
    <div class="missing-fields-section mb-1">
        <div class="missing-title">
            <span>üìã Certificados pendientes:</span>
        </div>
        <ul class="missing-list mb-1">
            {{#each statusCertificates.missingFields}}
            <li class="missing-item">‚Ä¢ {{this}}</li>
            {{/each}}
        </ul>
    </div>
    {{/unless}}

    <form id="certificates-form" action="/api/certificates/upload" method="POST" enctype="multipart/form-data">
        <div class="cert-grid">
            <!-- Los 4 certificados se renderizan din√°micamente seg√∫n los booleanos -->

            <!-- Certificado de Matriculaci√≥n -->
            {{#if statusCertificates.c_matriculacion_cert}}
            <!-- VERSI√ìN HABILITADA -->
            <div class="cert-card enabled">
                <div class="cert-header">
                    <div class="cert-title">üìã Certificado de Matriculaci√≥n</div>
                    <div class="cert-icon enabled">‚úì</div>
                </div>
                <p class="cert-description">
                    Documento oficial que acredita la matriculaci√≥n del veh√≠culo.
                </p>
                <input type="file" name="doc_c_matriculacion_cert" id="doc_c_matriculacion_cert"
                    accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" class="cert-file-input" required>
                <div class="cert-status status-available">
                    ‚úÖ Disponible para subir
                </div>
            </div>
            {{else}}
            <!-- VERSI√ìN DESHABILITADA -->
            <div class="cert-card disabled">
                <div class="cert-header">
                    <div class="cert-title">üìã Certificado de Matriculaci√≥n</div>
                    <div class="cert-icon disabled">‚úó</div>
                </div>
                <p class="cert-description">
                    Documento oficial que acredita la matriculaci√≥n del veh√≠culo.
                </p>
                <input type="file" name="doc_c_matriculacion_cert" id="doc_c_matriculacion_cert"
                    accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" class="cert-file-input" disabled>
                <div class="cert-status status-pending">
                    ‚è≥ Pendiente de habilitaci√≥n
                </div>
            </div>
            {{/if}}

            <!-- Certificado de Seguro -->
            {{#if statusCertificates.seguro_cert}}
            <!-- VERSI√ìN HABILITADA -->
            <div class="cert-card enabled">
                <div class="cert-header">
                    <div class="cert-title">üõ°Ô∏è Certificado de Seguro</div>
                    <div class="cert-icon enabled">‚úì</div>
                </div>
                <p class="cert-description">
                    P√≥liza de seguro vigente del veh√≠culo con cobertura completa.
                </p>
                <input type="file" name="doc_seguro_cert" id="doc_seguro_cert" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                    class="cert-file-input" required>
                <div class="cert-status status-available">
                    ‚úÖ Disponible para subir
                </div>
            </div>
            {{else}}
            <!-- VERSI√ìN DESHABILITADA -->
            <div class="cert-card disabled">
                <div class="cert-header">
                    <div class="cert-title">üõ°Ô∏è Certificado de Seguro</div>
                    <div class="cert-icon disabled">‚úó</div>
                </div>
                <p class="cert-description">
                    P√≥liza de seguro vigente del veh√≠culo con cobertura completa.
                </p>
                <input type="file" name="doc_seguro_cert" id="doc_seguro_cert" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                    class="cert-file-input" disabled>
                <div class="cert-status status-pending">
                    ‚è≥ Pendiente de habilitaci√≥n
                </div>
            </div>
            {{/if}}

            <!-- Certificado RTO -->
            {{#if statusCertificates.rto_cert}}
            <!-- VERSI√ìN HABILITADA -->
            <div class="cert-card enabled">
                <div class="cert-header">
                    <div class="cert-title">üöó Certificado RTO</div>
                    <div class="cert-icon enabled">‚úì</div>
                </div>
                <p class="cert-description">
                    Certificado de Registro de Transporte de Oficina (RTO).
                </p>
                <input type="file" name="doc_rto_cert" id="doc_rto_cert" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                    class="cert-file-input" required>
                <div class="cert-status status-available">
                    ‚úÖ Disponible para subir
                </div>
            </div>
            {{else}}
            <!-- VERSI√ìN DESHABILITADA -->
            <div class="cert-card disabled">
                <div class="cert-header">
                    <div class="cert-title">üöó Certificado RTO</div>
                    <div class="cert-icon disabled">‚úó</div>
                </div>
                <p class="cert-description">
                    Certificado de Registro de Transporte de Oficina (RTO).
                </p>
                <input type="file" name="doc_rto_cert" id="doc_rto_cert" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                    class="cert-file-input" disabled>
                <div class="cert-status status-pending">
                    ‚è≥ Pendiente de habilitaci√≥n
                </div>
            </div>
            {{/if}}

            <!-- Certificado de Tac√≥grafo -->
            {{#if statusCertificates.tacografo_cert}}
            <!-- VERSI√ìN HABILITADA -->
            <div class="cert-card enabled">
                <div class="cert-header">
                    <div class="cert-title">üìä Certificado de Tac√≥grafo</div>
                    <div class="cert-icon enabled">‚úì</div>
                </div>
                <p class="cert-description">
                    Certificado de calibraci√≥n y funcionamiento del tac√≥grafo.
                </p>
                <input type="file" name="doc_tacografo_cert" id="doc_tacografo_cert"
                    accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" class="cert-file-input" required>
                <div class="cert-status status-available">
                    ‚úÖ Disponible para subir
                </div>
            </div>
            {{else}}
            <!-- VERSI√ìN DESHABILITADA -->
            <div class="cert-card disabled">
                <div class="cert-header">
                    <div class="cert-title">üìä Certificado de Tac√≥grafo</div>
                    <div class="cert-icon disabled">‚úó</div>
                </div>
                <p class="cert-description">
                    Certificado de calibraci√≥n y funcionamiento del tac√≥grafo.
                </p>
                <input type="file" name="doc_tacografo_cert" id="doc_tacografo_cert"
                    accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" class="cert-file-input" disabled>
                <div class="cert-status status-pending">
                    ‚è≥ Pendiente de habilitaci√≥n
                </div>
            </div>
            {{/if}}
        </div>

        <div class="form-actions">
            <button type="submit" class="submit-btn" id="submit-btn">
                <span>üì§ Subir Documentos</span>
                <span>‚Üí</span>
            </button>
        </div>
    </form>

    <div class="footer-info">
        Estado: <strong>{{#if statusCertificates.allComplete}}Completo{{else}}Incompleto{{/if}}</strong></p>
        <p>Formatos aceptados: PDF, JPG, PNG, DOC, DOCX (M√°x. 10MB por archivo)</p>
    </div>
</div>

<script type="module" src="/js/doc_register.js"></script>